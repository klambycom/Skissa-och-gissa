/*! Skissa-och-gissa 2013-05-26 01:31:33 */
Function.prototype.composite=function(a){"use strict";var b=this;return function(){var c=Array.prototype.slice.call(arguments);return b.call(this,a.apply(this,c))}},Function.prototype.curry=function(){"use strict";var a=Array.prototype.slice.call(arguments),b=this;return function(){var c=Array.prototype.slice.call(arguments);return b.apply(this,a.concat(c))}},Function.prototype.flip=function(){"use strict";var a=this;return function(){var b=Array.prototype.slice.call(arguments);return a.apply(this,b.reverse())}};var SOG=SOG||{};SOG.utils=SOG.utils||{},SOG.utils.namespace=function(a){"use strict";var b,c=a.split("."),d=SOG;for("SOG"===c[0]&&(c=c.slice(1)),b=0;b<c.length;b+=1)"undefined"==typeof d[c[b]]&&(d[c[b]]={}),d=d[c[b]];return d};var SOG=SOG||{};SOG.utils=SOG.utils||{},function(){"use strict";var a=function(a){var b=Array.prototype.slice,c=b.call(arguments,1);return function(){var d=b.call(arguments),e=c.concat(d);return a.apply(null,e)}};"undefined"==typeof window?module.exports=a:SOG.utils.currying=a}();var SOG=SOG||{};SOG.utils=SOG.utils||{},SOG.utils.html=function(a,b){"use strict";var c=document.createElement(a),d=b||{};return d.to&&(d.to.appendChild(c),delete d.to),d.text&&(c.innerHTML=d.text,delete d.text),"a"!==a||d.href||c.setAttribute("href","#"),Object.keys(d).forEach(function(a){c.setAttribute(a,d[a])}),c};var SOG=SOG||{};SOG.utils=SOG.utils||{},function(){"use strict";var a,b=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)},c=function(){return b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b()};a=function(b,d,e){return this instanceof a?(this.id=c(),this.fn=b,this.options=d,this.context=e,this.channel=null,void 0):new a(b,d,e)},a.prototype={update:function(a){a&&(this.fn=a.fn||this.fn,this.context=a.context||this.context,this.options=a.options||this.options,this.channel&&this.options&&void 0!==this.options.priority&&this.channel.setPriority(this.id,this.options.priority))}},SOG.utils.Subscriber=a}();var SOG=SOG||{};SOG.utils=SOG.utils||{},function(){"use strict";var a=function(b,c){return this instanceof a?(this.namespace=b||"",this._subscribers=[],this._channels=[],this._parent=c,this.stopped=!1,void 0):new a(b)};a.prototype={addSubscriber:function(a,b,c){var d=new SOG.utils.Subscriber(a,b,c);return b&&void 0!==b.priority?(b.priority=b.priority>>0,b.priority<0&&(b.priority=0),b.priority>this._subscribers.length&&(b.priority=this._subscribers.length-1),this._subscribers.splice(b.priority,0,d)):this._subscribers.push(d),d.channel=this,d},stopPropagation:function(){this.stopped=!0},getSubscriber:function(a){var b=0,c=this._subscribers.length;for(c;c>b;b+=1)if(this._subscribers[b].id===a||this._subscribers[b].fn===a)return this._subscribers[b]},setPriority:function(a,b){var c,d,e,f,g=0,h=0;for(h=0,f=this._subscribers.length;f>h&&this._subscribers[h].id!==a&&this._subscribers[h].fn!==a;h+=1)g+=1;c=this._subscribers[g],d=this._subscribers.slice(0,g),e=this._subscribers.slice(g+1),this._subscribers=d.concat(e),this._subscribers.splice(b,0,c)},addChannel:function(b){this._channels[b]=new a((this.namespace?this.namespace+":":"")+b,this)},hasChannel:function(a){return this._channels.hasOwnProperty(a)},returnChannel:function(a){return this._channels[a]},removeSubscriber:function(a){var b=this._subscribers.length-1;if(!a)return this._subscribers=[],void 0;for(b;b>=0;b-=1)(this._subscribers[b].fn===a||this._subscribers[b].id===a)&&(this._subscribers[b].channel=null,this._subscribers.splice(b,1))},publish:function(a){var b,c=0,d=this._subscribers.length,e=!1;for(d;d>c;c+=1)this.stopped||(b=this._subscribers[c],void 0!==b.options&&"function"==typeof b.options.predicate?b.options.predicate.apply(b.context,a)&&(b.fn.apply(b.context,a),e=!0):(b.fn.apply(b.context,a),e=!0)),e&&b.options&&void 0!==b.options&&(b.options.calls-=1,b.options.calls<1?(this.removeSubscriber(b.id),d-=1,c-=1):b.update(b.options));this._parent&&this._parent.publish(a),this.stopped=!1}},SOG.utils.Channel=a}();var SOG=SOG||{};SOG.utils=SOG.utils||{},SOG.utils.mediator=function(){"use strict";var a,b=new SOG.utils.Channel("");return a=function(a){var c=b,d=a.split(":"),e=0,f=d.length;if(""===a)return c;if(d.length>0)for(f;f>e;e+=1)c.hasChannel(d[e])||c.addChannel(d[e]),c=c.returnChannel(d[e]);return c},{subscribe:function(b,c,d,e){return d=d||{},e=e||{},a(b).addSubscriber(c,d,e)},once:function(a,b,c,d){return c=c||{},c.calls=1,this.subscribe(a,b,c,d)},getSubscriber:function(b,c){return a(c||"").getSubscriber(b)},remove:function(b,c){a(b).removeSubscriber(c)},publish:function(b){var c=Array.prototype.slice.call(arguments,1),d=a(b);c.push(d),d.publish(c)}}}(),function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["facebook.hbs"]=a(function(a,b,c,d,e){this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||a.helpers,e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<div id="fb-user-data">\n  <img src="',(f=c.picture)?f=f.call(b,{hash:{},data:e}):(f=b.picture,f=typeof f===h?f.apply(b):f),g+=i(f)+'" alt="Bild på ',(f=c.name)?f=f.call(b,{hash:{},data:e}):(f=b.name,f=typeof f===h?f.apply(b):f),g+=i(f)+'">\n  <h1>',(f=c.name)?f=f.call(b,{hash:{},data:e}):(f=b.name,f=typeof f===h?f.apply(b):f),g+=i(f)+'</h1>\n</div>\n<div id="fb-user-btns">\n  <a href="#" id="fb-anonymous">Anonymitet, tack!</a>\n  <a href="#" id="fb-signout-button">Logga ut</a>\n</div>\n'})}(),function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["popup.hbs"]=a(function(a,b,c,d,e){function f(a,b){var d;return(d=c.message)?d=d.call(a,{hash:{},data:b}):(d=a.message,d=typeof d===l?d.apply(a):d),m(d)}function g(a,b){var d;return(d=c.message)?d=d.call(a,{hash:{},data:b}):(d=a.message,d=typeof d===l?d.apply(a):d),d||0===d?d:""}function h(a,b){var d;return(d=c.extra)?d=d.call(a,{hash:{},data:b}):(d=a.extra,d=typeof d===l?d.apply(a):d),m(d)}function i(a,b){var d;return(d=c.extra)?d=d.call(a,{hash:{},data:b}):(d=a.extra,d=typeof d===l?d.apply(a):d),d||0===d?d:""}this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||a.helpers,e=e||{};var j,k="",l="function",m=this.escapeExpression,n=this;return k+='<div id="popup">\n  <div class="title">',(j=c.title)?j=j.call(b,{hash:{},data:e}):(j=b.title,j=typeof j===l?j.apply(b):j),k+=m(j)+'</div>\n  <div class="message">',j=c["if"].call(b,b.escape,{hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e}),(j||0===j)&&(k+=j),k+='</div>\n  <div class="extra">',j=c["if"].call(b,b.escape,{hash:{},inverse:n.program(7,i,e),fn:n.program(5,h,e),data:e}),(j||0===j)&&(k+=j),k+="</div>\n</div>\n"})}(),function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["player.hbs"]=a(function(a,b,c,d,e){function f(){return" you"}this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||a.helpers,e=e||{};var g,h="",i=this,j="function",k=this.escapeExpression;return h+='<div class="player',g=c["if"].call(b,b.you,{hash:{},inverse:i.noop,fn:i.program(1,f,e),data:e}),(g||0===g)&&(h+=g),h+='" id="player-',(g=c.id)?g=g.call(b,{hash:{},data:e}):(g=b.id,g=typeof g===j?g.apply(b):g),h+=k(g)+'">\n  <img src="',(g=c.picture)?g=g.call(b,{hash:{},data:e}):(g=b.picture,g=typeof g===j?g.apply(b):g),h+=k(g)+'" alt="',(g=c.name)?g=g.call(b,{hash:{},data:e}):(g=b.name,g=typeof g===j?g.apply(b):g),h+=k(g)+'">\n  <div class="information">\n    <span class="name">',(g=c.name)?g=g.call(b,{hash:{},data:e}):(g=b.name,g=typeof g===j?g.apply(b):g),h+=k(g)+'</span>\n    <span class="points">',(g=c.points)?g=g.call(b,{hash:{},data:e}):(g=b.points,g=typeof g===j?g.apply(b):g),h+=k(g)+" poäng</span>\n  </div>\n</div>\n"})}(),function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["room.hbs"]=a(function(a,b,c,d,e){return this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||a.helpers,e=e||{},'<div id="chat-container">\n  <div id="game-user-info">\n    <div class="players">\n    </div>\n  </div>\n\n  <div id="chat">\n    <div id="chat-messages"></div>\n    <div id="chat-input">\n      <img src="gfx/nopic50.png">\n      <input type="text" placeholder="Gissa på ett ord.." autofocus>\n    </div>\n  </div>\n  <div id="crayons">\n    <h1>KRITA</h1>\n    <ul id="sizes">\n      <li class="size-5"><a href="#" data-size="5"></a></li>\n      <li class="size-10"><a href="#" data-size="10"></a></li>\n      <li class="size-15"><a href="#" data-size="15"></a></li>\n      <li class="size-20"><a href="#" data-size="20"></a></li>\n    </ul>\n    <h1>FÄRG</h1>\n    <ul id="colors">\n      <li class="white"><a href="#" data-color="white"></a></li>\n      <li class="black"><a href="#" data-color="black"></a></li>\n      <li class="red"><a href="#" data-color="red"></a></li>\n      <li class="orange"><a href="#" data-color="orange"></a></li>\n      <li class="yellow"><a href="#" data-color="yellow"></a></li>\n      <li class="yellowgreen"><a href="#" data-color="yellowgreen"></a></li>\n      <li class="green"><a href="#" data-color="green"></a></li>\n      <li class="lightskyblue"><a href="#" data-color="lightskyblue"></a></li>\n      <li class="dodgerblue"><a href="#" data-color="dodgerblue"></a></li>\n      <li class="violet"><a href="#" data-color="violet"></a></li>\n      <li class="pink"><a href="#" data-color="pink"></a></li>\n      <li class="burlywood"><a href="#" data-color="burlywood"></a></li>\n      <li class="saddlebrown"><a href="#" data-color="saddlebrown"></a></li>\n      <li class="brown"><a href="#" data-color="brown"></a></li>\n    </ul>\n  </div>\n</div>\n\n<div id="gameplan">\n  <div id="timer">\n    <div id="timer-progress"></div>\n  </div>\n  <div id="artboard-wrapper">\n    <canvas id="artboard" width="800" height="600"></canvas>\n  </div>\n</div>\n'})}(),function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["message.hbs"]=a(function(a,b,c,d,e){this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||a.helpers,e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<div class="message',(f=c.css)?f=f.call(b,{hash:{},data:e}):(f=b.css,f=typeof f===h?f.apply(b):f),g+=i(f)+'">\n  <img src="',(f=c.picture)?f=f.call(b,{hash:{},data:e}):(f=b.picture,f=typeof f===h?f.apply(b):f),g+=i(f)+'" alt="',(f=c.name)?f=f.call(b,{hash:{},data:e}):(f=b.name,f=typeof f===h?f.apply(b):f),g+=i(f)+'">\n  <p>',(f=c.message)?f=f.call(b,{hash:{},data:e}):(f=b.message,f=typeof f===h?f.apply(b):f),g+=i(f)+"</p>\n</div>\n"})}(),function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["servermessage.hbs"]=a(function(a,b,c,d,e){this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||a.helpers,e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<div class="server-message">\n  # ',(f=c.message)?f=f.call(b,{hash:{},data:e}):(f=b.message,f=typeof f===h?f.apply(b):f),g+=i(f)+"\n</div>\n"})}(),function(){var a=Handlebars.template,b=Handlebars.templates=Handlebars.templates||{};b["donemessage.hbs"]=a(function(a,b,c,d,e){this.compilerInfo=[3,">= 1.0.0-rc.4"],c=c||a.helpers,e=e||{};var f,g="",h="function",i=this.escapeExpression;return g+='<div class="drawing-done">\n  <div class="word">',(f=c.word)?f=f.call(b,{hash:{},data:e}):(f=b.word,f=typeof f===h?f.apply(b):f),g+=i(f)+'</div>\n  <img src="',(f=c.img)?f=f.call(b,{hash:{},data:e}):(f=b.img,f=typeof f===h?f.apply(b):f),g+=i(f)+'" alt="',(f=c.word)?f=f.call(b,{hash:{},data:e}):(f=b.word,f=typeof f===h?f.apply(b):f),g+=i(f)+'" style="width: 100%">\n  <img src="gfx/nopic50.png" alt="" class="user" />\n  <div class="by">',(f=c.name)?f=f.call(b,{hash:{},data:e}):(f=b.name,f=typeof f===h?f.apply(b):f),g+=i(f)+"</div>\n</div>\n"})}(),SOG.utils.namespace("SOG.browser.game"),SOG.browser.game=function(){"use strict";var a=io.connect(),b={GameNotFoundException:{title:"Spelet hittades inte",message:"Spelet finns inte längre. Du har kanske fått en gammal länk eller inte laddat om sidan på länge.",extra:"Lösning: Det borde fungera att ladda om sidan!"},GameIsFullException:{title:"Spelet är fullt",message:"Det får tyvärr inte plats med fler spelare i detta spelet. Det borde finnas fler spel i samma kategori."},DisconnectedException:{title:":(",message:"Anslutningen till servern har brutits. Möjliga anledningar: <ul><li>Jag uppdaterar spelet (bra).</li><li>Servern har kraschat (dåligt).</li><li>Du har varit inaktiv väldigt länge (tråkigt).</li></ul>",extra:"Vänta ett par minuter och testa sen att ladda om sidan.",escape:!1},ScoreMessage:"{gName} fick {gPoints} ponäng efter att ha gissat rätt. {dName} fick {dPoints} poäng för att har ritat så bra."};return{onError:function(b){a.on("error-message",b),a.on("disconnect",b.curry({name:"DisconnectedException"}))},onConnect:function(b){a.on("connect",b)},getSocket:function(){return a},str:function(a){return b[a]},onPoints:function(b){a.on("update-points",function(a){b({player:new SOG.browser.Player(a.guess_player),points:a.guess_points,total:a.guess_total},{player:new SOG.browser.Player(a.draw_player),points:a.draw_points,total:a.draw_total})})}}}(),SOG.utils.namespace("SOG.browser.Point"),function(){"use strict";SOG.browser.Point=function(a,b,c,d,e){this.getX=function(){return a},this.getY=function(){return b},this.getColor=function(){return d},this.getSize=function(){return e},this.getDragging=function(){return c}},SOG.browser.Point.prototype.data=function(){return{x:this.getX(),y:this.getY(),color:this.getColor(),size:this.getSize(),dragging:this.getDragging()}}}(),SOG.utils.namespace("SOG.browser.points"),SOG.browser.points=function(a){"use strict";var b="#df4b26",c=5,d=[];return{add:function(e,f,g){var h;return h=e instanceof Object?new a(e.x,e.y,!!e.dragging,e.color,e.size):new a(e,f,!!g,b,c),d.push(h),h},test:function(){return d},setColor:function(a){b=a},setSize:function(a){c=a},clear:function(){d=[]},each:function(a){var b,c,e;for(b=0;b<d.length;b+=1)c=d[b-1]&&d[b-1].data(),e=d[b].data(),a(c,e)},last:function(a){var b=d.length-1,c=d[b-1]&&d[b-1].data(),e=d[b].data();a(c,e)}}}(SOG.browser.Point),SOG.utils.namespace("SOG.browser.artboard"),SOG.browser.artboard=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n;return d=function(a){c=!0,g(a.pageX,a.pageY)},e=function(){c=!1},f=function(a){c&&g(a.pageX,a.pageY,!0)},n=function(b){a.add(b),a.last(h)},g=function(c,d,e){var f=c-b.canvas.offsetLeft-j,g=d-b.canvas.offsetTop-k,i=a.add(f,g,e);m.sendPoints(i.data()),a.last(h)},h=function(a,c){("undefined"==typeof a||a.color!==c.color||a.size!==c.size)&&(b.strokeStyle=c.color,b.lineWidth=c.size),b.beginPath(),c.dragging&&b.moveTo(a.x,a.y),b.lineTo(c.x,c.y),b.closePath(),b.stroke()},i=function(){b.clearRect(0,0,b.canvas.width,b.canvas.height),b.lineJoin="round",a.each(h)},l=function(a){return["blue_crayon","green_crayon","pink_crayon","yellow_crayon","red_crayon"].forEach(function(a){b.canvas.classList.remove(a)}),b.canvas.classList.add(a+"_crayon"),a},{init:function(a){a.canvas.onselectstart=function(){return!1},m=a.room,j=a.x||0,k=a.y||0,b=a.canvas.getContext("2d"),this.clear(),m.onReceivePoint(n)},enable:function(){b.canvas.addEventListener("mousedown",d),b.canvas.addEventListener("mouseup",e),b.canvas.addEventListener("mousemove",f),b.canvas.addEventListener("mouseleave",e),b.canvas.addEventListener("mouseout",e)},disable:function(){b.canvas.removeEventListener("mousedown",d),b.canvas.removeEventListener("mouseup",e),b.canvas.removeEventListener("mousemove",f),b.canvas.removeEventListener("mouseleave",e),b.canvas.removeEventListener("mouseout",e)},clear:function(){c=!1,a.clear(),b.clearRect(0,0,b.canvas.width,b.canvas.height),b.lineJoin="round",l("red")},setColor:a.setColor.composite(l),setSize:a.setSize,eraser:function(){a.setSize(20),a.setColor("white")},getImage:function(){return b.canvas.toDataURL()}}}(SOG.browser.points),function(){"use strict";var a=function(a){this.getAllData=function(){return a},this.getSocketID=function(){return a.socket},this.setSocketID=function(b){a.socket=b},this.getName=function(){return a.name},this.getFullName=this.getName,this.setFullName=function(b){a.name=b},this.getFacebookID=function(){return a.id},this.getFirstName=function(){return a.first_name},this.getPicture=function(){return a.picture&&a.picture.data.url||"gfx/nopic50.png"},this.getFriends=function(){return a.friends.data},this.getFacebookUsername=function(){return a.username},this.getFacebookLink=function(){return a.link},this.updateData=function(b){a=b};var b=0;this.points=function(a){return b=0===a?0:b+(a||0)}};a.prototype.getObject=function(a,b){var c={},d=this;return a.forEach(function(a){c[a]=d["get"+a.capitalize()]()}),b?Object.merge(c,b(this)):c},a.prototype.listFriends=function(a){return this.getFriends().map(function(b){return b[a||"id"]})},a.prototype.getFriendsFromIds=function(a){return this.getFriends().filter(function(b){return-1!==a.indexOf(b.id)})},"undefined"==typeof window?exports.Player=a:(SOG.utils.namespace("SOG.shared.Player"),SOG.shared.Player=a)}(),SOG.utils.namespace("SOG.browser.Player"),function(){"use strict";var a=function(a){SOG.shared.Player.call(this,a)};a.prototype=Object.create(SOG.shared.Player.prototype),a.prototype.join=function(a){var b=this;this.room=a.get("socket"),this.room.on("identify-player",function(a){b.setSocketID(a.id),b.room.emit("identify-player",b.getAllData())})},a.prototype.sendMessage=function(a){this.room.emit("user-message",a)},a.prototype.onDataChanged=function(a){var b=this;this.room.on("update-player-data",function(){a(b)})},a.prototype.updateData=function(a){SOG.shared.Player.prototype.updateData.call(this,a)},a.prototype.updateDataSkit=function(a){this.room.emit("update-player-data",a),this.updateData(a)},a.prototype.saveImage=function(a){this.room.emit("save-image",a)},SOG.browser.Player=a}(),function(){"use strict";var a=function(a){this.get=function(b){return a[b]},this.set=function(b,c){a[b]=c}};"undefined"==typeof window?module.exports=a:(SOG.utils.namespace("SOG.shared.Room"),SOG.shared.Room=a)}(),SOG.utils.namespace("SOG.browser.Room"),function(){"use strict";SOG.browser.Room=function(a){SOG.shared.Room.call(this,a),this.set("socket",a.socket)},SOG.browser.Room.prototype=Object.create(SOG.shared.Room.prototype),SOG.browser.Room.prototype.onPlayerJoinsRoom=function(a){this.get("socket").on("player-joined-room",function(b){var c=new SOG.browser.Player(b.player);a(c,b)})},SOG.browser.Room.prototype.onUserMessage=function(a){this.get("socket").on("user-message",function(b){var c=new SOG.browser.Player(b.player);a(c,b.text,b)})},SOG.browser.Room.prototype.onServerMessage=function(a){this.get("socket").on("server-message",function(b){a(b.type||"",b.text)})},SOG.browser.Room.prototype.sendPoints=function(a){this.get("socket").emit("canvas",a)},SOG.browser.Room.prototype.onReceivePoint=function(a){this.get("socket").on("canvas",a)},SOG.browser.Room.prototype.onCorrectWordGuessed=function(a){this.get("socket").on("correct-word",a)},SOG.browser.Room.prototype.changeTo=function(a,b){this.get("socket").emit("join-room",a),this.get("socket").on("join-room",function(a){a.success?(a.players=a.players.map(function(a){return new SOG.browser.Player(a)}),b.success(a)):b.fail(a.message)})}}(),SOG.utils.namespace("SOG.browser.popup"),SOG.browser.popup=function(){"use strict";var a,b,c,d,e,f,g=Handlebars.templates["popup.hbs"],h=SOG.utils.html("div",{id:"popup-wrapper"}),i=document.getElementById("page-wrapper");return b=function(a){h.classList.remove("show"),setTimeout(function(){document.body.removeChild(h)},500),i.classList.remove("blur"),a&&a.preventDefault&&a.preventDefault(),h.removeEventListener("click",b)},c=function(c){"undefined"==typeof c.escape&&(c.escape=!0),c.closeable||"undefined"==typeof c.closeable?(h.classList.remove("not-closeable"),h.addEventListener("click",b)):h.classList.add("not-closeable"),i.classList.add("blur"),h.innerHTML=g(c),document.body.appendChild(h),a=document.getElementById("popup"),a.addEventListener("click",function(a){a.preventDefault(),a.stopPropagation()}),a.style.marginTop=(window.innerHeight-a.offsetHeight)/2+"px",setTimeout(function(){h.classList.add("show")},10)},d=function(a){var b=a.message||a,c=SOG.utils.html("div",{id:"simple-popup-message-wrapper",to:document.body});return SOG.utils.html("div",{"class":"simple-popup-message",text:b,to:c}),setTimeout(function(){document.body.removeChild(c)},1e4),c},f=function(b,c,d){e||(e=SOG.utils.html("div",{"class":"buttons",to:a}));var f=SOG.utils.html("a",{"class":d||"ok-btn",text:b,to:e});"string"==typeof c?f.setAttribute("href",c):f.addEventListener("click",function(a){c(),a.preventDefault()})},function(a,e){return"simple"===e?d(a):(c(a),{close:b,addBtn:f})}}(),SOG.utils.namespace("SOG.browser.chat"),SOG.browser.chat=function(){"use strict";var a,b,c,d=Handlebars.templates["message.hbs"],e=Handlebars.templates["servermessage.hbs"],f=Handlebars.templates["donemessage.hbs"];return{init:function(d){a=d.input,b=d.messages,c=d.player,a.addEventListener("keypress",function(a){13!==a.keyCode||this.value.isBlank()||(c.sendMessage(this.value),this.value="",a.preventDefault())})},createMessage:function(a,g,h){var i;i="string"==typeof a.img?f(a):"string"==typeof a||a instanceof String?e({message:g}):d({name:c.getFullName(),picture:"gfx/nopic30.png",message:g,css:h.win?" win":""}),b.innerHTML=i+b.innerHTML}}}(),SOG.utils.namespace("SOG.browser.crayons"),SOG.browser.crayons=function(){"use strict";var a,b,c;return a=function(){var a={};return function(b,c){var d=c.target||c;"undefined"!=typeof a[b]&&a[b].classList.remove("selected"),a[b]=d,d.classList.add("selected"),SOG.browser.artboard["set"+b.capitalize()](d.getAttribute("data-"+b)),c.preventDefault&&c.preventDefault()}}(),c=a.curry("color"),b=a.curry("size"),{init:function(a){c(a.colors[1]),b(a.sizes[0]),a.sizes.forEach(function(a){a.addEventListener("click",b)}),a.colors.forEach(function(a){a.addEventListener("click",c)})}}}(SOG.utils.currying),window.onload=function(){"use strict";var a,b,c,d=SOG.browser.game,e=new SOG.browser.Player({name:"Christian "+Date.now()+"son"}),f=new SOG.browser.Room({id:"room",name:"Lobby",socket:d.getSocket()}),g=[].slice.call(document.querySelectorAll("#games .game"));b=function(b){document.getElementById("page-wrapper").innerHTML=Handlebars.templates["room.hbs"]({});var c,g=document.querySelector("#gameplan"),h=document.querySelector("#chat-input input"),i=document.querySelector("#chat-messages"),j=document.querySelector("#page-wrapper"),k=document.querySelector("#game-user-info .players"),l=document.querySelector("#timer-progress"),m=Handlebars.templates["player.hbs"],n=SOG.browser.chat,o=SOG.browser.artboard;c=function(a){var b=a.getSocketID()===e.getSocketID();b||n.createMessage("",a.getName()+" har gått med i spelet!"),k.innerHTML+=m(a.getObject(["name","picture"],function(){return{points:214,you:b,id:a.getSocketID()}}))},n.init({input:h,messages:i,player:e}),b.players.forEach(c),f.onUserMessage(n.createMessage),f.onServerMessage(n.createMessage),o.init({canvas:document.querySelector("#artboard"),x:g.offsetLeft+5,y:g.offsetTop+5,room:f}),d.onPoints(function(a,b){n.createMessage("",d.str("ScoreMessage").assign({gName:a.player.getName(),gPoints:a.points,dName:b.player.getName(),dPoints:b.points})),document.querySelector("#player-"+a.player.getSocketID()+" .points").innerHTML=a.total+" poäng",document.querySelector("#player-"+b.player.getSocketID()+" .points").innerHTML=b.total+" poäng"}),f.onCorrectWordGuessed(function(b){"undefined"!=typeof a&&(g.removeChild(a),a=void 0,j.classList.remove("draw"),h.disabled=!1,document.onselectstart=function(){return!0}),b.next&&b.next.draw?(h.disabled=!0,document.onselectstart=function(){return!1},a=SOG.utils.html("div",{id:"word-wrapper",text:'<div id="word"><span class="text">Din tur att rita</span><span class="word">'+b.next.word+"</span>",to:g}),setTimeout(function(){a.classList.add("small"),j.classList.add("draw")},2e3),o.enable()):(window.setTimeout(function(){h.focus()},0),o.disable()),""!==b.word&&n.createMessage({img:o.getImage(),word:b.word,name:"Christian Nilsson"}),o.clear(),l.className="",setTimeout(function(){l.classList.add("min-"+(b.next.minutes||0))},2e3),console.log(b),console.log("correct word: "+b.word)}),f.onPlayerJoinsRoom(c),SOG.browser.crayons.init({sizes:[].slice.call(document.querySelectorAll("#sizes a")),colors:[].slice.call(document.querySelectorAll("#colors a"))}),window.testSaveImage=function(){e.saveImage(o.getImage())},window.testToggleDraw=function(){document.querySelector("#page-wrapper").classList.toggle("draw")}},c=function(a){console.log("An error occured: "+a)},e.join(f),e.onDataChanged(function(a){console.log(a)}),g.forEach(function(a){a.addEventListener("click",function(c){f.changeTo(a.dataset.name,{success:b,fail:SOG.browser.popup.flip().curry("simple")}),c.preventDefault()})}),d.onError(function(a){var b=SOG.browser.popup(d.str(a.name)||{title:a.name,message:a.message});"DisconnectedException"===a.name&&d.onConnect(function(){b.addBtn("Ok, anslut igen!","http://skissaochgissa.se")})})};